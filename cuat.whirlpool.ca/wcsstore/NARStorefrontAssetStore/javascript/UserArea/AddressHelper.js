AddressHelper={stateDivName:"stateDiv",stateClass:null,langId:"-1",storeId:"",storeCountry:null,catalogId:"",vEditableOptionIndex_A:0,vEditableOptionText_A:"Please select your security question",vPreviousSelectIndex_A:0,vSelectIndex_A:0,vSelectChange_A:"MANUAL_CLICK",displayNameRequired:"false",pickupAddressId:"",WHRAPACFLOW2:"",setWhrflow:function(value){this.WHRAPACFLOW2=value;},getWhrflow:function(){return this.WHRAPACFLOW2;},setStateDivName:function(stateDivName){this.stateDivName=stateDivName;},setStoreCountry:function(storeCountry){this.storeCountry=storeCountry;},setStateClass:function(stateClass){this.stateClass=stateClass;},setVEditableOptionIndex_A:function(vEditableOptionIndex_A){this.vEditableOptionIndex_A=vEditableOptionIndex_A;},setCommonParameters:function(langId,storeId,catalogId){this.langId=langId;this.storeId=storeId;this.catalogId=catalogId;},setDisplayNameRequired:function(displayNameRequired){this.displayNameRequired=displayNameRequired;},setPickupAddressId:function(pickupAddressId){this.pickupAddressId=pickupAddressId;},getCountryArray:function(){if(document.countries==null){countries=new Array();var theDiv=document.getElementById("countryListSelectionHelper");if(typeof theDiv=="undefined"){return null;}var divJSON=eval("("+theDiv.innerHTML+")");var countriesObject=divJSON.countries;for(var i=0;i<countriesObject.length;i++){var countryObject=countriesObject[i];countries[countryObject.code]=new Object();countries[countryObject.code].name=countryObject.displayName;countries[countryObject.code].countryCallingCode=countryObject.callingCode;if(countryObject.states.length>0){countries[countryObject.code].states=new Object();for(var j=0;j<countryObject.states.length;j++){var state=countryObject.states[j];countries[countryObject.code].states[state.code]=state.displayName;}}}}return countries;},disableField:function(unwantedElementId,wantedElementId){document.getElementById(unwantedElementId).setAttribute("name","unwanted_field");document.getElementById(wantedElementId).setAttribute("name","address3");},loadStatesUI:function(formName,paramPrefix,stateDiv,id,keepCurrentState,copyValue){this.getCountryArray();var form=document.getElementById(formName);if(paramPrefix==null||paramPrefix=="undefined"||paramPrefix==""){paramPrefix="";}var newid=paramPrefix+id;var currentState;if(keepCurrentState!=null&&keepCurrentState!="undefined"&&keepCurrentState==true){currentState=document.getElementById(newid).value;}else{currentState="";}if(copyValue!=null&&copyValue!="undefined"&&copyValue!=""){currentState=copyValue;}if(id=="_state1"){this.setStateClass("form_input");var currentCountryCode=form[paramPrefix+"_country"].value;}else{var currentCountryCode=form[paramPrefix+"country"].value;}var stateDivObj=document.getElementById(stateDiv);if(dojo.isIE){var stateClass=document.getElementById(newid).getAttribute("className");}else{var stateClass=document.getElementById(newid).getAttribute("class");}if(stateClass!="drop_down_country"){this.setStateClass(stateClass);}while(stateDivObj.hasChildNodes()){stateDivObj.removeChild(stateDivObj.firstChild);}if(countries[currentCountryCode].states){stateDivObj.appendChild(this.createStateWithOptions(paramPrefix,currentCountryCode,currentState,id));}else{stateDivObj.appendChild(this.createState(paramPrefix,currentState,id));}},createState:function(paramPrefix,currentState,id){var stateInput=document.createElement("input");stateInput.setAttribute("id",paramPrefix+id);if(id=="_state1"){stateInput.setAttribute("name",paramPrefix+"_state");}else{stateInput.setAttribute("name",paramPrefix+"state");}stateInput.setAttribute("class",this.stateClass);stateInput.setAttribute("className",this.stateClass);stateInput.setAttribute("size","35");stateInput.setAttribute("maxlength","49");if(currentState!=null&&currentState!="undefined"){stateInput.setAttribute("value",currentState);}return stateInput;},createStateWithOptions:function(paramPrefix,currentCountryCode,currentState,id){this.getCountryArray();var stateSelect=document.createElement("select");stateSelect.setAttribute("id",paramPrefix+id);if(id=="_state1"){stateSelect.setAttribute("name",paramPrefix+"_state");}else{stateSelect.setAttribute("name",paramPrefix+"state");}stateSelect.setAttribute("class","drop_down_country");stateSelect.setAttribute("className","drop_down_country");stateSelect.options.length=0;for(state_code in countries[currentCountryCode].states){aOption=document.createElement("option");stateSelect.options[stateSelect.length]=aOption;aOption.text=countries[currentCountryCode].states[state_code];aOption.value=state_code;if(state_code==currentState||countries[currentCountryCode].states[state_code]==currentState){aOption.selected=true;}}return stateSelect;},validateAddressForm:function(form,prefix){reWhiteSpace=new RegExp(/^\s+$/);if(prefix==null){prefix="";}if(prefix){this.setStateDivName(prefix+"stateDiv");}if(form!=null){var fields="";if(form.AddressForm_FieldsOrderByLocale!=null&&form.AddressForm_FieldsOrderByLocale.value!=null&&form.AddressForm_FieldsOrderByLocale.value!=""){fields=form.AddressForm_FieldsOrderByLocale.value.split(",");}else{if(document.getElementById("AddressForm_FieldsOrderByLocale").value!=null&&document.getElementById("AddressForm_FieldsOrderByLocale").value!=""){fields=document.getElementById("AddressForm_FieldsOrderByLocale").value.split(",");}}var nickName=prefix+"nickName";var personTitle=prefix+"personTitle";var lastName=prefix+"lastName";var firstName=prefix+"firstName";var middleName=prefix+"middleName";var address1=prefix+"address1";var address2=prefix+"address2";var address3=prefix+"address3";var address31=prefix+"address31";var city=prefix+"city";var city1=prefix+"city1";var state=prefix+"state";var state1=prefix+"state1";var country=prefix+"country";var zipCode=prefix+"zipCode";var email1=prefix+"email1";var phone1=prefix+"phone1";var phone2=prefix+"phone2";var mobilePhone1=prefix+"mobilePhone1";var mphone_length=10;var purchase_termsCondtion_chkbox=prefix+"purchase_termsCondtion_chkbox";if(document.getElementById("storeIdentifier")!=null&&document.getElementById("storeIdentifier").value=="KAD_CN_B2C"){mphone_length=11;}for(var i=0;i<form.elements.length;i++){formElement=form.elements[i];if(formElement.getAttribute("type")=="text"||formElement.nodeName.toLowerCase()=="select"){document.getElementById(formElement.id).style.background="#ffffff";}}for(var i1=0;i1<fields.length;i1++){var ifield=fields[i1];if(ifield=="COUNTRY/REGION"||ifield=="country/region"){if(typeof(form[country])!="undefined"){form[country].value=trim(form[country].value);this.setStoreCountry(form[country].value);}}}for(var i=0;i<fields.length;i++){var field=fields[i];if(field=="NICK_NAME"||field=="nick_name"){form[nickName].value=trim(form[nickName].value);if(field=="NICK_NAME"&&(form[nickName].value==""||reWhiteSpace.test(form[nickName].value))){MessageHelper.formErrorHandleClient(form[nickName].id,MessageHelper.messages.ERROR_RecipientEmpty);document.getElementById(form[nickName].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[nickName].value,254)){MessageHelper.formErrorHandleClient(form.nickName.id,MessageHelper.messages.ERROR_RecipientTooLong);document.getElementById(form[nickName].id).style.background="#ff0000";return false;}}else{if(field=="PERSON_TITLE"||field=="person_title"){}else{if(field=="FIRST_NAME"||field=="first_name"){form[firstName].value=trim(form[firstName].value);if(field=="FIRST_NAME"&&(form[firstName].value==""||reWhiteSpace.test(form[firstName].value))){MessageHelper.formErrorHandleClient(form[firstName].id,MessageHelper.messages.ERROR_FirstNameEmpty);document.getElementById(form[firstName].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[firstName].value,40)){MessageHelper.formErrorHandleClient(form[firstName].id,MessageHelper.messages.ERROR_FirstNameTooLong);document.getElementById(form[firstName].id).style.background="#ff0000";return false;}}else{if(field=="LAST_NAME"||field=="last_name"){form[lastName].value=trim(form[lastName].value);if(field=="LAST_NAME"&&(form[lastName].value==""||reWhiteSpace.test(form[lastName].value))){MessageHelper.formErrorHandleClient(form[lastName].id,MessageHelper.messages.ERROR_LastNameEmpty);document.getElementById(form[lastName].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[lastName].value,40)){MessageHelper.formErrorHandleClient(form[lastName].id,MessageHelper.messages.ERROR_LastNameTooLong);document.getElementById(form[lastName].id).style.background="#ff0000";return false;}}else{if(field=="MIDDLE_NAME"||field=="middle_name"){form[middleName].value=trim(form[middleName].value);if(field=="MIDDLE_NAME"&&(form[middleName].value==""||reWhiteSpace.test(form[middleName].value))){MessageHelper.formErrorHandleClient(form[middleName].id,MessageHelper.messages.ERROR_MiddleNameEmpty);document.getElementById(form[middleName].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[middleName].value,128)){MessageHelper.formErrorHandleClient(form[middleName].id,MessageHelper.messages.ERROR_MiddleNameTooLong);document.getElementById(form[middleName].id).style.background="#ff0000";return false;}}else{if(field=="ADDRESS"||field=="address"){form[address1].value=trim(form[address1].value);if(field=="ADDRESS"&&((form[address1].value==""||reWhiteSpace.test(form[address1].value)))){MessageHelper.formErrorHandleClient(form[address1].id,MessageHelper.messages.ERROR_AddressEmpty);document.getElementById(form[address1].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[address1].value,160)){MessageHelper.formErrorHandleClient(form[address1].id,MessageHelper.messages.ERROR_AddressTooLong);document.getElementById(form[address1].id).style.background="#ff0000";return false;}}else{if(field=="HOUSENUMBER"||field=="housenumber"){form[address2].value=trim(form[address2].value);if(field=="HOUSENUMBER"&&(form[address2].value==""||reWhiteSpace.test(form[address2].value))){MessageHelper.formErrorHandleClient(form[address2].id,MessageHelper.messages.ERROR_HouseNumberEmpty);document.getElementById(form[address2].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[address2].value,40)){MessageHelper.formErrorHandleClient(form[address2].id,MessageHelper.messages.ERROR_HouseNumberTooLong);document.getElementById(form[address2].id).style.background="#ff0000";return false;}}else{if(field=="PO_BOX"||field=="po_box"){if(typeof(form[address3])!="undefined"){form[address3].value=trim(form[address3].value);if(field=="PO_BOX"&&(form[address3].value==""||reWhiteSpace.test(form[address3].value))){MessageHelper.formErrorHandleClient(form[address3].id,MessageHelper.messages.ERROR_POBoxEmpty);document.getElementById(form[address3].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[address3].value,50)){MessageHelper.formErrorHandleClient(form[address3].id,MessageHelper.messages.ERROR_POBoxTooLong);document.getElementById(form[address3].id).style.background="#ff0000";return false;}}}else{if(field=="CITY"||field=="city"){form[city].value=trim(form[city].value);if(this.WHRAPACFLOW2=="true"||this.WHRAPACFLOW2==true){if((form[city].value==null||form[city].value==""||reWhiteSpace.test(form[city].value))&&typeof(form[city1])!="undefined"){form[city].value=form[city1].value;var optVal=trim(form[city1].value);var citySelectDropDown=form[city];var option=document.createElement("option");option.text=optVal;option.value=optVal;citySelectDropDown.add(option);citySelectDropDown.value=optVal;}}if(field=="CITY"&&(form[city].value==""||reWhiteSpace.test(form[city].value))){MessageHelper.formErrorHandleClient(form[city].id,MessageHelper.messages.ERROR_CityEmpty);document.getElementById(form[city].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[city].value,40)){MessageHelper.formErrorHandleClient(form[city].id,MessageHelper.messages.ERROR_CityTooLong);document.getElementById(form[city].id).style.background="#ff0000";return false;}}else{if(field=="STATE/PROVINCE"||field=="state/province"){var stateObj=form[state];if(stateObj==null||stateObj==""){stateObj=document.getElementById(this.stateDivName).firstChild;}if(this.WHRAPACFLOW2=="true"||this.WHRAPACFLOW2==true){if((stateObj.value==null||stateObj.value==""||reWhiteSpace.test(stateObj.value))&&typeof(form[state1])!="undefined"){stateObj=form[state1];var optVal=trim(stateObj.value);var stateSelectDropDown=form[state];var option=document.createElement("option");option.text=optVal;option.value=optVal;stateSelectDropDown.add(option);stateSelectDropDown.value=optVal;}}stateObj.value=trim(stateObj.value);if(field=="STATE/PROVINCE"&&(stateObj.value==null||stateObj.value==""||reWhiteSpace.test(stateObj.value))){MessageHelper.formErrorHandleClient(stateObj.id,MessageHelper.messages.ERROR_StateEmpty);document.getElementById(stateObj.id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(stateObj.value,128)){MessageHelper.formErrorHandleClient(stateObj.id,MessageHelper.messages.ERROR_StateTooLong);document.getElementById(stateObj.id).style.background="#ff0000";return false;}}else{if(field=="COUNTRY/REGION"||field=="country/region"){if(typeof(form[country])!="undefined"){form[country].value=trim(form[country].value);if(field=="COUNTRY/REGION"&&(form[country].value==""||reWhiteSpace.test(form[country].value))){MessageHelper.formErrorHandleClient(form[country].id,MessageHelper.messages.ERROR_CountryEmpty);document.getElementById(form[country].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[country].value,128)){MessageHelper.formErrorHandleClient(form[country].id,MessageHelper.messages.ERROR_CountryTooLong);document.getElementById(form[country].id).style.background="#ff0000";return false;}}}else{if(field=="district"||field=="DISTRICT"){form[address3].value=trim(form[address3].value);if(this.WHRAPACFLOW2=="true"||this.WHRAPACFLOW2==true){if((form[address3].value==null||form[address3].value==""||reWhiteSpace.test(form[address3].value))&&typeof(form[address31])!="undefined"){form[address3].value=form[address31].value;var optVal=trim(form[address31].value);var districtSelectDropDown=form[address3];var option=document.createElement("option");option.text=optVal;option.value=optVal;districtSelectDropDown.add(option);districtSelectDropDown.value=optVal;}}if(field=="DISTRICT"&&(form[address3].value==""||reWhiteSpace.test(form[address3].value))){MessageHelper.formErrorHandleClient(form[address3].id,MessageHelper.messages.ERROR_DistrictEmpty);document.getElementById(form[address3].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[address3].value,40)){MessageHelper.formErrorHandleClient(form[address3].id,MessageHelper.messages.ERROR_DistrictTooLong);document.getElementById(form[address3].id).style.background="#ff0000";return false;}}else{if(field=="ZIP"||field=="zip"){form[zipCode].value=trim(form[zipCode].value);if(form[zipCode].value!=""||!reWhiteSpace.test(form[zipCode].value)){var myzip=form[zipCode].value;form[zipCode].value=myzip.toUpperCase();}if(field=="ZIP"&&(form[zipCode].value==""||reWhiteSpace.test(form[zipCode].value))){MessageHelper.formErrorHandleClient(form[zipCode].id,MessageHelper.messages.ERROR_ZipCodeEmpty);document.getElementById(form[zipCode].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[zipCode].value,40)){MessageHelper.formErrorHandleClient(form[zipCode].id,MessageHelper.messages.ERROR_ZipCodeTooLong);document.getElementById(form[zipCode].id).style.background="#ff0000";return false;}if(this.storeCountry=="CA"){if(!this.isValidCAZipCode(form[zipCode].value)){MessageHelper.formErrorHandleClient(form[zipCode].id,MessageHelper.messages.ERROR_InvalidZipCode);document.getElementById(form[zipCode].id).style.background="#ff0000";return false;}}else{if(!this.isValidZipCode(form[zipCode].value)&&this.WHRAPACFLOW2!="true"){MessageHelper.formErrorHandleClient(form[zipCode].id,MessageHelper.messages.ERROR_InvalidZipCode);document.getElementById(form[zipCode].id).style.background="#ff0000";return false;}}}else{if(field=="EMAIL1"||field=="email1"){form[email1].value=trim(form[email1].value);if(field=="EMAIL1"&&(form[email1].value==""||reWhiteSpace.test(form[email1].value))){MessageHelper.formErrorHandleClient(form[email1].id,MessageHelper.messages.ERROR_EmailEmpty);document.getElementById(form[email1].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[email1].value,100)){MessageHelper.formErrorHandleClient(form[email1].id,MessageHelper.messages.ERROR_EmailTooLong);document.getElementById(form[email1].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidEmail(form[email1].value)||form[email1].value.substring(0,4)=="www."){MessageHelper.formErrorHandleClient(form[email1].id,MessageHelper.messages.ERROR_INVALIDEMAILFORMAT);document.getElementById(form[email1].id).style.background="#ff0000";return false;}}else{if(field=="PHONE1"||field=="phone1"){form[phone1].value=trim(form[phone1].value);if(field=="PHONE1"&&(form[phone1].value==""||reWhiteSpace.test(form[phone1].value))){MessageHelper.formErrorHandleClient(form[phone1].id,MessageHelper.messages.ERROR_PhonenumberEmpty);document.getElementById(form[phone1].id).style.background="#ff0000";return false;}if(!(MessageHelper.utf8StringByteLength(form[phone1].value)==10)){MessageHelper.formErrorHandleClient(form[phone1].id,MessageHelper.messages.ERROR_INVALIDPHONE);document.getElementById(form[phone1].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[phone1].value,32)){MessageHelper.formErrorHandleClient(form[phone1].id,MessageHelper.messages.ERROR_PhoneTooLong);document.getElementById(form[phone1].id).style.background="#ff0000";return false;}if(!MessageHelper.IsValidPhone(form[phone1].value)){MessageHelper.formErrorHandleClient(form[phone1].id,MessageHelper.messages.ERROR_INVALIDPHONE);document.getElementById(form[phone1].id).style.background="#ff0000";return false;}}else{if(field=="PHONE2"||field=="phone2"){form[phone2].value=trim(form[phone2].value);if(field=="PHONE2"&&(form[phone2].value==""||reWhiteSpace.test(form[phone2].value))){MessageHelper.formErrorHandleClient(form[phone2].id,MessageHelper.messages.ERROR_PhonenumberEmpty);document.getElementById(form[phone2].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[phone2].value,32)){MessageHelper.formErrorHandleClient(form[phone2].id,MessageHelper.messages.ERROR_PhoneTooLong);document.getElementById(form[phone2].id).style.background="#ff0000";return false;}if(!MessageHelper.IsValidPhone(form[phone2].value)){MessageHelper.formErrorHandleClient(form[phone2].id,MessageHelper.messages.ERROR_INVALIDPHONE);document.getElementById(form[phone2].id).style.background="#ff0000";return false;}}else{if(field=="MPHONE1"||field=="mphone1"){if(typeof form[mobilePhone1]=="undefined"){continue;}form[mobilePhone1].value=trim(form[mobilePhone1].value);if(field=="MPHONE1"&&(form[mobilePhone1].value==""||reWhiteSpace.test(form[mobilePhone1].value))){MessageHelper.formErrorHandleClient(form[mobilePhone1].id,MessageHelper.messages.ERROR_PhonenumberEmpty);document.getElementById(form[mobilePhone1].id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form[mobilePhone1].value,mphone_length)){MessageHelper.formErrorHandleClient(form[mobilePhone1].id,MessageHelper.messages.ERROR_MobilePhoneTooLong);document.getElementById(form[mobilePhone1].id).style.background="#ff0000";return false;}if(!MessageHelper.IsValidPhone(form[mobilePhone1].value)){MessageHelper.formErrorHandleClient(form[mobilePhone1].id,MessageHelper.messages.ERROR_INVALIDMOBILEPHONE);document.getElementById(form[mobilePhone1].id).style.background="#ff0000";return false;}if(field=="MPHONE1"&&!(MessageHelper.utf8StringByteLength(form[mobilePhone1].value)==mphone_length)){MessageHelper.formErrorHandleClient(form[mobilePhone1].id,MessageHelper.messages.ERROR_INVALIDMOBILEPHONE);document.getElementById(form[mobilePhone1].id).style.background="#ff0000";return false;}}else{if(field=="purchase_termsCondtion_chkbox"){if(typeof form[purchase_termsCondtion_chkbox]!="undefined"){form[purchase_termsCondtion_chkbox].value=trim(form[purchase_termsCondtion_chkbox].value);if(form[purchase_termsCondtion_chkbox].checked==false){MessageHelper.formErrorHandleClient(form[purchase_termsCondtion_chkbox].id,MessageHelper.messages.ERROR_PurchaseTermsAndConditions);return false;}}}else{console.debug("error: mandatory field name "+mandatoryField+" is not recognized.");return false;}}}}}}}}}}}}}}}}}}}if(typeof form.phone1_1!="undefined"&&form.phone1_1!=null){form.phone1.value=form.phone1_1.value+"-"+form.phone1_2.value;}return true;}return false;},saveShopCartAddress:function(serviceId,formName,countyLabelId,zipCodeValidationReqd){var form=document.forms[formName];if(form.addressType!=null&&form.addressType.value=="ShippingAndBilling"){serviceId="AjaxAddShippingAndBillingAddressForPersonDuringCheckout";}if(this.validateAddressForm(form)){if(form.emailFlagInput_chkbox&&form.emailFlagInput_chkbox.checked){form.emailFlagInput.value="false";}else{form.emailFlagInput.value="true";}this.getTaxCodeByZipSB(formName,"",formName+"_countySelect",countyLabelId,zipCodeValidationReqd,dojo.hitch(this,function(){this.enableCityStateZipSB(formName,"",countyLabelId);this.saveAddress(serviceId,formName);}));}},saveShopCartAddressOffline:function(serviceId,formName,countyLabelId,zipCodeValidationReqd){var form=document.forms[formName];if(form.addressType!=null&&form.addressType.value=="ShippingAndBilling"){serviceId="AjaxAddShippingAndBillingAddressForPersonDuringCheckout";}if(this.validateAddressForm(form)){if(form.emailFlagInput_chkbox&&form.emailFlagInput_chkbox.checked){form.emailFlagInput.value="false";}else{form.emailFlagInput.value="true";}this.enableCityStateZipSB(formName,"",countyLabelId);this.saveAddress(serviceId,formName);}},validateCheckoutAddressZipCode:function(formName,successCallback){var form=document.getElementById(formName);var city=form.city.value;var country=form.country.options[form.country.selectedIndex].value;var zipCode=form.zipCode.value;wc.service.declare({id:"validateUnregisteredCheckoutZipCode",actionId:"validateUnregisteredCheckoutZipCode",url:"AjaxValidateZipCode",formId:"",successHandler:function(serviceResponse){cursor_clear();successCallback();},failureHandler:function(serviceResponse){cursor_clear();if(serviceResponse.errorCode=="5090"){MessageHelper.formErrorHandleClient(form.city.id,MessageHelper.messages.ERROR_CityEmpty);document.getElementById(form.city.id).style.background="#ff0000";}else{if(serviceResponse.errorCode=="5130"){MessageHelper.formErrorHandleClient(form.zipCode.id,MessageHelper.messages.ERROR_ZipCodeEmpty);document.getElementById(form.zipCode.id).style.background="#ff0000";}else{if(serviceResponse.errorCode=="5140"){MessageHelper.formErrorHandleClient(form.zipCode.id,MessageHelper.messages.ERROR_InvalidJurisdisctionCode);document.getElementById(form.zipCode.id).style.background="#ff0000";}else{if(serviceResponse.errorCode==""||serviceResponse.errorCode==null){MessageHelper.formErrorHandleClient(form.zipCode.id,MessageHelper.messages.ERROR_WebserviceUnavailable_TryLater);document.getElementById(form.zipCode.id).style.background="#ff0000";}}}}return false;}});if(!submitRequest()){return;}var params=[];params.langId=langId;params.storeId=storeId;params.catalogId=catalogId;params.city=city;params.country=country;params.zipCode=zipCode;cursor_wait();wc.service.invoke("validateUnregisteredCheckoutZipCode",params);},saveUnregisteredCheckoutAddress:function(formName1,formName2,stateDivName1,stateDivName2,paramPrefix,countyLabelId,zipCodeValidationReqd){var form1=document.forms[formName1];this.setStateDivName(stateDivName1);var that=this;if(this.validateAddressForm(form1)){this.getTaxCodeByZipSB(formName1,paramPrefix,formName1+"_countySelect",countyLabelId,zipCodeValidationReqd,dojo.hitch(this,function(){var sameaddress=document.getElementById("SameShippingAndBillingAddress");if(document.getElementById("storeIdentifier")!=null){var storeIdentifier=document.getElementById("storeIdentifier").value;if(storeIdentifier=="WP_CA_EPP"||storeIdentifier=="WP_CA_B2C"||storeIdentifier=="MTG_CA_B2C"||storeIdentifier=="KAD_CA_B2C"){if(form1.emailFlagInput_chkbox&&form1.emailFlagInput_chkbox.checked){form1.emailFlagInput.value="true";}else{form1.emailFlagInput.value="false";}}else{if(form1.emailFlagInput_chkbox&&form1.emailFlagInput_chkbox.checked){form1.emailFlagInput.value="false";}else{form1.emailFlagInput.value="true";}}}if(!sameaddress.checked){var form2=document.forms[formName2];this.setStateDivName(stateDivName2);if(this.validateAddressForm(form2)){this.getTaxCodeByZipSB(formName2,paramPrefix,formName2+"_countySelect",countyLabelId,zipCodeValidationReqd,dojo.hitch(this,function(){this.enableCityStateZipSB(formName1,paramPrefix,countyLabelId);this.enableCountry(formName1,paramPrefix);this.enableCityStateZipSB(formName2,paramPrefix,countyLabelId);this.enableCountry(formName2,paramPrefix);this.saveAddress("AddBillingAddress","billingAddressCreateEditFormDiv_1");}));}}else{form1.addressType.value="ShippingAndBilling";this.enableCityStateZipSB(formName1,paramPrefix,countyLabelId);this.enableCountry(formName1,paramPrefix);this.saveAddress("AddShippingAddress","billingAddressCreateEditFormDiv_1");}}));}},saveUnregisteredCheckoutAddressOffline:function(formName1,formName2,stateDivName1,stateDivName2,paramPrefix,countyLabelId,zipCodeValidationReqd){var form1=document.forms[formName1];this.setStateDivName(stateDivName1);var that=this;if(this.validateAddressForm(form1)){var sameaddress=document.getElementById("SameShippingAndBillingAddress");if(form1.emailFlagInput_chkbox&&form1.emailFlagInput_chkbox.checked){form1.emailFlagInput.value="false";}else{form1.emailFlagInput.value="true";}if(!sameaddress.checked){var form2=document.forms[formName2];this.setStateDivName(stateDivName2);if(this.validateAddressForm(form2)){this.enableCityStateZipSB(formName1,paramPrefix,countyLabelId);this.enableCountry(formName1,paramPrefix);this.enableCityStateZipSB(formName2,paramPrefix,countyLabelId);this.enableCountry(formName2,paramPrefix);this.saveAddress("AddBillingAddress","billingAddressCreateEditFormDiv_1");}}else{form1.addressType.value="ShippingAndBilling";this.enableCityStateZipSB(formName1,paramPrefix,countyLabelId);this.enableCountry(formName1,paramPrefix);this.saveAddress("AddShippingAddress","billingAddressCreateEditFormDiv_1");}}},saveRegisteredCheckoutAddressOffline:function(formName1,formName2,stateDivName1,stateDivName2,paramPrefix,countyLabelId,zipCodeValidationReqd){var form1=document.forms[formName1];this.setStateDivName(stateDivName1);var that=this;if(this.validateAddressForm(form1)){var sameaddress=document.getElementById("SameShippingAndBillingAddress");if(form1.emailFlagInput_chkbox&&form1.emailFlagInput_chkbox.checked){form1.emailFlagInput.value="false";}else{form1.emailFlagInput.value="true";}if(!sameaddress.checked){var form2=document.forms[formName2];this.setStateDivName(stateDivName2);if(this.validateAddressForm(form2)){this.enableCityStateZipSB(formName1,paramPrefix,countyLabelId);this.enableCountry(formName1,paramPrefix);this.enableCityStateZipSB(formName2,paramPrefix,countyLabelId);this.enableCountry(formName2,paramPrefix);this.saveAddress("AjaxUpdateProfileAddressForRegisteredUser","billingAddressCreateEditFormDiv_1");}}else{form1.addressType.value="ShippingAndBilling";this.enableCityStateZipSB(formName1,paramPrefix,countyLabelId);this.enableCountry(formName1,paramPrefix);this.saveAddress("AjaxUpdateIncompleteAddressForPerson","billingAddressCreateEditFormDiv_1");}}},saveRegisteredCheckoutAddress:function(formName1,formName2,stateDivName1,stateDivName2,paramPrefix,countyLabelId,zipCodeValidationReqd){var form1=document.forms[formName1];this.setStateDivName(stateDivName1);var that=this;if(this.validateAddressForm(form1)){this.getTaxCodeByZipSB(formName1,paramPrefix,formName1+"_countySelect",countyLabelId,zipCodeValidationReqd,dojo.hitch(this,function(){var sameaddress=document.getElementById("SameShippingAndBillingAddress");if(document.getElementById("storeIdentifier")!=null){var storeIdentifier=document.getElementById("storeIdentifier").value;if(storeIdentifier=="WP_CA_EPP"||storeIdentifier=="WP_CA_B2C"||storeIdentifier=="MTG_CA_B2C"||storeIdentifier=="KAD_CA_B2C"){if(form1.emailFlagInput_chkbox&&form1.emailFlagInput_chkbox.checked){form1.emailFlagInput.value="true";}else{form1.emailFlagInput.value="false";}}else{if(form1.emailFlagInput_chkbox&&form1.emailFlagInput_chkbox.checked){form1.emailFlagInput.value="false";}else{form1.emailFlagInput.value="true";}}}if(!sameaddress.checked){var form2=document.forms[formName2];this.setStateDivName(stateDivName2);if(this.validateAddressForm(form2)){this.getTaxCodeByZipSB(formName2,paramPrefix,formName2+"_countySelect",countyLabelId,zipCodeValidationReqd,dojo.hitch(this,function(){this.enableCityStateZipSB(formName1,paramPrefix,countyLabelId);this.enableCountry(formName1,paramPrefix);this.enableCityStateZipSB(formName2,paramPrefix,countyLabelId);this.enableCountry(formName2,paramPrefix);this.saveAddress("AjaxUpdateProfileAddressForRegisteredUser","billingAddressCreateEditFormDiv_1");}));}}else{form1.addressType.value="ShippingAndBilling";this.enableCityStateZipSB(formName1,paramPrefix,countyLabelId);this.enableCountry(formName1,paramPrefix);this.saveAddress("AjaxUpdateIncompleteAddressForPerson","billingAddressCreateEditFormDiv_1");}}));}},savePayPalCheckoutAddress:function(formName1,formName2,stateDivName1,stateDivName2,paramPrefix,countyLabelId,zipCodeValidationReqd){var form1=document.forms[formName1];this.setStateDivName(stateDivName1);var that=this;if(this.validateAddressForm(form1)){this.getTaxCodeByZipSB(formName1,paramPrefix,formName1+"_countySelect",countyLabelId,zipCodeValidationReqd,dojo.hitch(this,function(){var sameaddress=document.getElementById("SameShippingAndBillingAddress");var storeIdentifier=document.getElementById("storeIdentifier").value;if(storeIdentifier=="WP_CA_EPP"||storeIdentifier=="WP_CA_B2C"||storeIdentifier=="MTG_CA_B2C"||storeIdentifier=="KAD_CA_B2C"){if(form1.emailFlagInput_chkbox&&form1.emailFlagInput_chkbox.checked){form1.emailFlagInput.value="true";}else{form1.emailFlagInput.value="false";}}else{if(form1.emailFlagInput_chkbox&&form1.emailFlagInput_chkbox.checked){form1.emailFlagInput.value="false";}else{form1.emailFlagInput.value="true";}}if(!sameaddress.checked){var form2=document.forms[formName2];this.setStateDivName(stateDivName2);if(this.validateAddressForm(form2)){this.getTaxCodeByZipSB(formName2,paramPrefix,formName2+"_countySelect",countyLabelId,zipCodeValidationReqd,dojo.hitch(this,function(){this.enableCityStateZipSB(formName1,paramPrefix,countyLabelId);this.enableCountry(formName1,paramPrefix);this.enableCityStateZipSB(formName2,paramPrefix,countyLabelId);this.enableCountry(formName2,paramPrefix);this.saveAddress("AjaxUpdateIncompletePayPalAddress","billingAddressCreateEditFormDiv_1");}));}}else{form1.addressType.value="ShippingAndBilling";this.enableCityStateZipSB(formName1,paramPrefix,countyLabelId);this.enableCountry(formName1,paramPrefix);this.saveAddress("AjaxUpdatePayPalSameddressForPerson","billingAddressCreateEditFormDiv_1");}}));}},updatePickupAddress:function(formName){var form1=document.forms[formName];var that=this;if(this.validateAddressForm(form1)){if(this.pickupAddressId!=""){form1.addressId.value=this.pickupAddressId;console.debug("Setting pickup addressId returned by service:"+this.pickupAddressId);}this.saveAddress("AjaxUpdateWillCallAddressForPerson",formName);}},updateShippingAddressForAllItems:function(shippingAddressId){var addressId=shippingAddressId;if(addressId==-1){return;}params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.orderId=".";params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.allocate="***";params.backorder="***";params.remerge="***";params.check="*n";params.addressId=addressId;if(!submitRequest()){return;}cursor_wait();wc.service.invoke("AjaxUpdateShippingAddressIdForOrder",params);},saveAddress:function(serviceId,formName){var form=document.forms[formName];if(form.address1.value==""&&form.address2.value!=""){form.address1.value=form.address2.value;form.address2.value="";}var addressService=wc.service.getServiceById(serviceId);addressService.formId=formName;if(!submitRequest()){return;}cursor_wait();wc.service.invoke(serviceId);},updateOrderAfterAddressUpdate:function(){var params=[];params.storeId=this.storeId;params.catalogId=this.catalogId;params.langId=this.langId;params.calculationUsage="-1,-2,-3,-4,-5,-6,-7";params.orderId=".";cursor_wait();wc.service.invoke("AjaxUpdateOrderAfterAddressUpdate",params);},loadCountryCode:function(countryDropDownId,countryCallingCodeId){this.getCountryArray();var countryCode=document.getElementById(countryDropDownId).value;document.getElementById(countryCallingCodeId).value=countries[countryCode].countryCallingCode;},enableSMSNotifications:function(form){var form=document.forms[form];if(form.mobilePhone1.value!=""){form.sendMeSMSNotification.disabled=false;form.sendMeSMSPreference.disabled=false;}else{form.sendMeSMSNotification.disabled=true;form.sendMeSMSPreference.disabled=true;form.sendMeSMSNotification.checked=false;form.sendMeSMSPreference.checked=false;}},setAddressTypeInCreatingNewAddressDuringCheckout:function(checkbox,form){if(form.addressType!=null&&form.originalAddressType!=null){if(checkbox.checked){form.addressType.value="ShippingAndBilling";}else{form.addressType.value=form.originalAddressType.value;}}},showWillCallMessage:function(){if(document.getElementById("WC_Selected")&&document.getElementById("WC_Selected").value=="true"&&document.getElementById("WC_error").value=="true"){MessageHelper.displayErrorMessage(MessageHelper.messages.ERR_WILLCALL_GENERIC_EXCEPTION);}},isNumberKey:function(evt){var charCode=(evt.which)?evt.which:event.keyCode;if(charCode>31&&(charCode<48||charCode>57)){return false;}if(charCode==13){return false;}return true;},isAlphaNumberKey:function(evt){var charCode=(evt.which)?evt.which:event.keyCode;if((charCode>=97&&charCode<=122)||(charCode>=48&&charCode<=57)||(charCode>=65&&charCode<=90)||charCode==8){return true;}else{return false;}},isValidZipCode:function(zipCode){if(MessageHelper.utf8StringByteLength(zipCode)<5&&MessageHelper.IsNumeric(zipCode)){return false;}else{var ValidChars="0123456789-";var IsValid=true;var Char;for(i=0;i<zipCode.length&&IsValid==true;i++){Char=zipCode.charAt(i);if(ValidChars.indexOf(Char)==-1){IsValid=false;}}return IsValid;}},isValidCAZipCode:function(zipCode){if(MessageHelper.utf8StringByteLength(zipCode)<6){return false;}else{var isValid=true;var expression=new RegExp(/^[ABCEGHJKLMNPRSTVXYabceghjklmnprstvxy]\d[A-Za-z]\s\d[A-Za-z]\d$/);isValid=expression.test(zipCode);return isValid;}},getTaxCodeByZip:function(formName,paramPrefix,id,lableId,zipCodeValidationReqd){var form=document.getElementById(formName);if(paramPrefix==null||paramPrefix=="undefined"||paramPrefix==""){paramPrefix="";}var newid=paramPrefix+id;var countyDivObj=document.getElementById(paramPrefix+"countyDiv");var city=form[paramPrefix+"city"].value;var country=form[paramPrefix+"country"].value;var zipCode=form[paramPrefix+"zipCode"].value;var stateObj=form[paramPrefix+"state"];var state="";if("select-one"==stateObj.type){state=stateObj.options[stateObj.selectedIndex].value;}else{state=stateObj.value;}if(zipCode!=""){form[paramPrefix+"zipCode"].value=zipCode.toUpperCase();zipCode=zipCode.toUpperCase();}document.getElementById(lableId).style.display="none";while(countyDivObj.hasChildNodes()){countyDivObj.removeChild(countyDivObj.firstChild);}wc.service.declare({id:"validateZipCode",actionId:"validateZipCode",url:"AjaxValidateZipCode",formId:"",successHandler:function(serviceResponse){var taxCodes=new Array();var taxCodeJurItems=serviceResponse.taxCodeJurItems;for(var i=0;i<taxCodeJurItems.length;i++){var taxCodeJurObject=taxCodeJurItems[i];taxCodes[i]=new Object();taxCodes[i].county=taxCodeJurObject.county;taxCodes[i].taxJuriCode=taxCodeJurObject.taxJuriCode;}while(countyDivObj.hasChildNodes()){countyDivObj.removeChild(countyDivObj.firstChild);}if(taxCodes.length>1){var countySelect=document.createElement("select");countySelect.setAttribute("id",newid);if(id=="_county1"){countySelect.setAttribute("name",paramPrefix+"_taxGeoCode");}else{countySelect.setAttribute("name",paramPrefix+"taxGeoCode");}countySelect.setAttribute("class","drop_down_country");countySelect.setAttribute("className","drop_down_country");countySelect.onchange=function(){AddressHelper.setCounty(paramPrefix,id);};countySelect.options.length=0;for(var i=0;i<taxCodes.length;i++){aOption=document.createElement("option");countySelect.options[i]=aOption;aOption.text=taxCodes[i].county;aOption.value=taxCodes[i].taxJuriCode;if(i==0){aOption.selected=true;}}countyDivObj.appendChild(countySelect);var countyInput=document.createElement("input");countyInput.setAttribute("type","hidden");countyInput.setAttribute("id",paramPrefix+"addressField1");if(id=="_county1"){countyInput.setAttribute("name",paramPrefix+"_addressField1");}else{countyInput.setAttribute("name",paramPrefix+"addressField1");}countyInput.setAttribute("value",taxCodes[0].county);countyDivObj.appendChild(countyInput);countyDivObj.style.display="block";document.getElementById(lableId).style.display="block";}else{if(taxCodes.length==1){document.getElementById(lableId).style.display="none";var countyInput=document.createElement("input");countyInput.setAttribute("type","hidden");countyInput.setAttribute("id",paramPrefix+"addressField1");if(id=="_county1"){countyInput.setAttribute("name",paramPrefix+"_addressField1");}else{countyInput.setAttribute("name",paramPrefix+"addressField1");}countyInput.setAttribute("value",taxCodes[0].county);countyDivObj.appendChild(countyInput);var taxGeoCodeInput=document.createElement("input");taxGeoCodeInput.setAttribute("type","hidden");taxGeoCodeInput.setAttribute("id",paramPrefix+id);if(id=="_county1"){taxGeoCodeInput.setAttribute("name",paramPrefix+"_taxGeoCode");}else{taxGeoCodeInput.setAttribute("name",paramPrefix+"taxGeoCode");}taxGeoCodeInput.setAttribute("value",taxCodes[0].taxJuriCode);countyDivObj.appendChild(taxGeoCodeInput);}}document.getElementById(paramPrefix+"validate_btn").style.display="none";document.getElementById(paramPrefix+"edit_btn").style.display="block";form[paramPrefix+"city"].readOnly=true;form[paramPrefix+"zipCode"].readOnly=true;stateObj.disabled=true;cursor_clear();},failureHandler:function(serviceResponse){document.getElementById(lableId).style.display="none";while(countyDivObj.hasChildNodes()){countyDivObj.removeChild(countyDivObj.firstChild);}if(serviceResponse.errorCode=="5090"){MessageHelper.formErrorHandleClient(form[paramPrefix+"city"].id,MessageHelper.messages.ERROR_CityEmpty);}if(serviceResponse.errorCode=="5110"){MessageHelper.formErrorHandleClient(form[paramPrefix+"state"].id,MessageHelper.messages.ERROR_StateEmpty);}if(serviceResponse.errorCode=="5130"){MessageHelper.formErrorHandleClient(form[paramPrefix+"zipCode"].id,MessageHelper.messages.ERROR_ZipCodeEmpty);}if(serviceResponse.errorCode=="5140"){MessageHelper.formErrorHandleClient(form[paramPrefix+"zipCode"].id,MessageHelper.messages.ERROR_InvalidJurisdisctionCode);}if(serviceResponse.errorCode==""||serviceResponse.errorCode==null){if(!zipCodeValidationReqd){var taxGeoCodeInput=document.createElement("input");taxGeoCodeInput.setAttribute("type","hidden");taxGeoCodeInput.setAttribute("id",paramPrefix+id);if(id=="_county1"){taxGeoCodeInput.setAttribute("name",paramPrefix+"_taxGeoCode");}else{taxGeoCodeInput.setAttribute("name",paramPrefix+"taxGeoCode");}taxGeoCodeInput.setAttribute("value","");countyDivObj.appendChild(taxGeoCodeInput);var countyInput=document.createElement("input");countyInput.setAttribute("type","hidden");countyInput.setAttribute("id",paramPrefix+"_addressField1");if(id=="_county1"){countyInput.setAttribute("name",paramPrefix+"_addressField1");}else{countyInput.setAttribute("name",paramPrefix+"addressField1");}countyInput.setAttribute("value","");countyDivObj.appendChild(countyInput);MessageHelper.formErrorHandleClient(form[paramPrefix+"zipCode"].id,MessageHelper.messages.ERROR_WebserviceUnavailable_Continue);}else{MessageHelper.formErrorHandleClient(form[paramPrefix+"zipCode"].id,MessageHelper.messages.ERROR_WebserviceUnavailable_TryLater);}}cursor_clear();return false;}});if(!submitRequest()){return;}var params=[];params.langId=langId;params.storeId=storeId;params.catalogId=catalogId;params.city=city;params.country=country;params.zipCode=zipCode;params.state=state;cursor_wait();wc.service.invoke("validateZipCode",params);},getTaxCodeByZipSB:function(formName,paramPrefix,id,lableId,zipCodeValidationReqd,successCallback){var form=document.getElementById(formName);if(paramPrefix==null||paramPrefix=="undefined"||paramPrefix==""){paramPrefix="";}var countyDivObj=document.getElementById(formName+"_countyDiv");var city=form[paramPrefix+"city"].value;var country=form[paramPrefix+"country"].value;var countryObj=form[paramPrefix+"country"];var zipCode=form[paramPrefix+"zipCode"].value;var stateObj=form[paramPrefix+"state"];var state="";if("select-one"==stateObj.type){state=stateObj.options[stateObj.selectedIndex].value;}else{state=stateObj.value;}if(zipCode!=""){form[paramPrefix+"zipCode"].value=zipCode.toUpperCase();zipCode=zipCode.toUpperCase();}if(document.getElementById(paramPrefix+id)&&"select-one"==document.getElementById(paramPrefix+id).type){form[paramPrefix+"city"].readOnly=false;form[paramPrefix+"zipCode"].readOnly=false;stateObj.disabled=false;countryObj.disabled=false;if(successCallback){successCallback();}return;}var countyLabelObj=document.getElementById(formName+"_"+lableId);countyLabelObj.style.display="none";while(countyDivObj.hasChildNodes()){countyDivObj.removeChild(countyDivObj.firstChild);}wc.service.declare({id:"validateZipCode",actionId:"validateZipCode",url:"AjaxValidateZipCode",formId:"",successHandler:function(serviceResponse){requestSubmitted=false;var taxCodes=new Array();var taxCodeJurItems=serviceResponse.taxCodeJurItems;for(var i=0;i<taxCodeJurItems.length;i++){var taxCodeJurObject=taxCodeJurItems[i];taxCodes[i]=new Object();taxCodes[i].county=taxCodeJurObject.county;taxCodes[i].taxJuriCode=taxCodeJurObject.taxJuriCode;}while(countyDivObj.hasChildNodes()){countyDivObj.removeChild(countyDivObj.firstChild);}var createCountyInput=function(){var countyInput=document.createElement("input");countyInput.setAttribute("type","hidden");countyInput.setAttribute("id",paramPrefix+"addressField1");if(id=="_county1"){countyInput.setAttribute("name",paramPrefix+"_addressField1");}else{countyInput.setAttribute("name",paramPrefix+"addressField1");}countyInput.setAttribute("value",taxCodes[0].county);countyDivObj.appendChild(countyInput);};var createTaxCodeInput=function(value){var taxGeoCodeInput=document.createElement("input");taxGeoCodeInput.setAttribute("type","hidden");taxGeoCodeInput.setAttribute("id",paramPrefix+id);if(id=="_county1"){taxGeoCodeInput.setAttribute("name",paramPrefix+"_taxGeoCode");}else{taxGeoCodeInput.setAttribute("name",paramPrefix+"taxGeoCode");}taxGeoCodeInput.setAttribute("value",value);countyDivObj.appendChild(taxGeoCodeInput);};if(taxCodes.length>1){var countySelect=document.createElement("select");countySelect.setAttribute("id",paramPrefix+id);if(id=="_county1"){countySelect.setAttribute("name",paramPrefix+"_taxGeoCode");}else{countySelect.setAttribute("name",paramPrefix+"taxGeoCode");}countySelect.setAttribute("class","drop_down_country");countySelect.setAttribute("className","drop_down_country");countySelect.onchange=function(){AddressHelper.setCountySB(formName,paramPrefix,id);};countySelect.options.length=0;for(var i=0;i<taxCodes.length;i++){aOption=document.createElement("option");countySelect.options[i]=aOption;aOption.text=taxCodes[i].county;aOption.value=taxCodes[i].taxJuriCode;if(i==0){aOption.selected=true;}}countyDivObj.appendChild(countySelect);createCountyInput();countyDivObj.style.display="block";countyLabelObj.style.display="block";form[paramPrefix+"city"].readOnly=true;form[paramPrefix+"zipCode"].readOnly=true;stateObj.disabled=true;countryObj.disabled=true;MessageHelper.formErrorHandleClient(form[paramPrefix+id].id,MessageHelper.messages.ERROR_SelectCounty);document.getElementById(form[paramPrefix+id].id).style.background="#ff0000";}else{if(taxCodes.length==1){countyLabelObj.style.display="none";createCountyInput();createTaxCodeInput(taxCodes[0].taxJuriCode);successCallback();}}},failureHandler:function(serviceResponse){requestSubmitted=false;countyLabelObj.style.display="none";while(countyDivObj.hasChildNodes()){countyDivObj.removeChild(countyDivObj.firstChild);}if(serviceResponse.errorCode=="5090"){MessageHelper.formErrorHandleClient(form[paramPrefix+"city"].id,MessageHelper.messages.ERROR_CityEmpty);document.getElementById(form[paramPrefix+"city"].id).style.background="#ff0000";}else{if(serviceResponse.errorCode=="5110"){MessageHelper.formErrorHandleClient(form[paramPrefix+"state"].id,MessageHelper.messages.ERROR_StateEmpty);document.getElementById(form[paramPrefix+"state"].id).style.background="#ff0000";}else{if(serviceResponse.errorCode=="5130"){MessageHelper.formErrorHandleClient(form[paramPrefix+"zipCode"].id,MessageHelper.messages.ERROR_ZipCodeEmpty);document.getElementById(form[paramPrefix+"zipCode"].id).style.background="#ff0000";}else{if(serviceResponse.errorCode=="5140"){MessageHelper.formErrorHandleClient(form[paramPrefix+"zipCode"].id,MessageHelper.messages.ERROR_InvalidJurisdisctionCode);document.getElementById(form[paramPrefix+"zipCode"].id).style.background="#ff0000";}else{if(serviceResponse.errorCode==""||serviceResponse.errorCode==null){if(!zipCodeValidationReqd){createCountyInput();createTaxCodeInput("");MessageHelper.formErrorHandleClient(form[paramPrefix+"zipCode"].id,MessageHelper.messages.ERROR_WebserviceUnavailable_Continue);}else{MessageHelper.formErrorHandleClient(form[paramPrefix+"zipCode"].id,MessageHelper.messages.ERROR_WebserviceUnavailable_TryLater);}}}}}}return false;}});if(!submitRequest()){return;}var params=[];params.langId=langId;params.storeId=storeId;params.catalogId=catalogId;params.city=city;params.country=country;params.zipCode=zipCode;params.state=state;wc.service.invoke("validateZipCode",params);},setCounty:function(paramPrefix,id){if(paramPrefix==null||paramPrefix=="undefined"||paramPrefix==""){paramPrefix="";}var newid=paramPrefix+id;var countyDivObj=document.getElementById(paramPrefix+"countyDiv");var countyObj=document.getElementById(newid);if(countyDivObj.hasChildNodes()){countyDivObj.removeChild(countyDivObj.lastChild);}var countyInput=document.createElement("input");countyInput.setAttribute("type","hidden");countyInput.setAttribute("id",paramPrefix+"_addressField1");if(id=="_county1"){countyInput.setAttribute("name",paramPrefix+"_addressField1");}else{countyInput.setAttribute("name",paramPrefix+"addressField1");}countyInput.setAttribute("value",countyObj.options[countyObj.selectedIndex].text);countyDivObj.appendChild(countyInput);},setCountySB:function(formName,paramPrefix,id){if(paramPrefix==null||paramPrefix=="undefined"||paramPrefix==""){paramPrefix="";}var newid=paramPrefix+id;var countyDivObj=document.getElementById(formName+"_countyDiv");var countyObj=document.getElementById(newid);if(countyDivObj.hasChildNodes()){countyDivObj.removeChild(countyDivObj.lastChild);}var countyInput=document.createElement("input");countyInput.setAttribute("type","hidden");countyInput.setAttribute("id",paramPrefix+"_addressField1");if(id=="_county1"){countyInput.setAttribute("name",paramPrefix+"_addressField1");}else{countyInput.setAttribute("name",paramPrefix+"addressField1");}countyInput.setAttribute("value",countyObj.options[countyObj.selectedIndex].text);countyDivObj.appendChild(countyInput);},enableCityStateZip:function(formName,paramPrefix,lableId,preserveCountyDiv){if(paramPrefix==null||paramPrefix=="undefined"||paramPrefix==""){paramPrefix="";}var form=document.getElementById(formName);form[paramPrefix+"city"].readOnly=false;form[paramPrefix+"zipCode"].readOnly=false;form[paramPrefix+"state"].disabled=false;document.getElementById(paramPrefix+"validate_btn").style.display="block";document.getElementById(paramPrefix+"edit_btn").style.display="none";document.getElementById(lableId).style.display="none";while(document.getElementById(paramPrefix+"countyDiv").hasChildNodes()){document.getElementById(paramPrefix+"countyDiv").removeChild(document.getElementById(paramPrefix+"countyDiv").firstChild);}},enableCityStateZipSB:function(formName,paramPrefix,lableId){if(paramPrefix==null||paramPrefix=="undefined"||paramPrefix==""){paramPrefix="";}var form=document.getElementById(formName);form[paramPrefix+"city"].readOnly=false;form[paramPrefix+"zipCode"].readOnly=false;form[paramPrefix+"state"].disabled=false;},enableCountry:function(formName,paramPrefix){var form=document.getElementById(formName);if(paramPrefix==null||paramPrefix==undefined){paramPrefix="";}var countryObj=form[paramPrefix+"country"];countryObj.disabled=false;},fnLeftToRight:function(getdropdown){getdropdown.style.direction="ltr";},fnRightToLeft:function(getdropdown){getdropdown.style.direction="rtl";},FindKeyCode:function(e){if(e.which){keycode=e.which;}else{keycode=e.keyCode;}return keycode;},FindKeyChar:function(e){keycode=this.FindKeyCode(e);if((keycode==8)||(keycode==127)){character="backspace";}else{if((keycode==46)){character="delete";}else{character=String.fromCharCode(keycode);}}return character;},fnSanityCheck_A:function(getdropdown){if(this.vEditableOptionIndex_A>(getdropdown.options.length-1)){return false;}if(getdropdown.options[getdropdown.options.selectedIndex].value.length>=100){return false;}},fnKeyDownHandler_A:function(getdropdown,e){this.fnSanityCheck_A(getdropdown);var vEventKeyCode=this.FindKeyCode(e);if(vEventKeyCode==37){this.fnLeftToRight(getdropdown);}if(vEventKeyCode==39){this.fnRightToLeft(getdropdown);}if(vEventKeyCode==8||vEventKeyCode==127){if(getdropdown.options.length!=0){if(getdropdown.options.selectedIndex==this.vEditableOptionIndex_A){if((getdropdown[this.vEditableOptionIndex_A].text==this.vEditableOptionText_A)||(getdropdown[this.vEditableOptionIndex_A].value==this.vEditableOptionText_A)){getdropdown.options[getdropdown.options.selectedIndex].text="";getdropdown.options[getdropdown.options.selectedIndex].value="";}else{getdropdown.options[getdropdown.options.selectedIndex].text=getdropdown.options[getdropdown.options.selectedIndex].text.slice(0,-1);getdropdown.options[getdropdown.options.selectedIndex].value=getdropdown.options[getdropdown.options.selectedIndex].value.slice(0,-1);}}}}if(getdropdown.options.length!=0){if(getdropdown.options.selectedIndex==this.vEditableOptionIndex_A){if((getdropdown[this.vEditableOptionIndex_A].text==this.vEditableOptionText_A)||(getdropdown[this.vEditableOptionIndex_A].value==this.vEditableOptionText_A)){getdropdown.options[getdropdown.options.selectedIndex].text="";getdropdown.options[getdropdown.options.selectedIndex].value="";}}}if(e.which){keycode=e.which;keycode="";}else{e.keyCode="";}if(e.cancelBubble){e.cancelBubble=true;e.returnValue=false;}if(e.stopPropagation){e.stopPropagation();}if(e.preventDefault){var is_chrome=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;if(is_chrome){if(e.which==8||e.which==127){e.preventDefault();}}else{e.preventDefault();}}},fnChangeHandler_A:function(getdropdown){this.fnSanityCheck_A(getdropdown);this.vPreviousSelectIndex_A=this.vSelectIndex_A;this.vSelectIndex_A=getdropdown.options.selectedIndex;if((this.vPreviousSelectIndex_A==(this.vEditableOptionIndex_A))&&(this.vSelectIndex_A!=(this.vEditableOptionIndex_A))&&(this.vSelectChange_A!="MANUAL_CLICK")){getdropdown[(this.vEditableOptionIndex_A)].selected=true;this.vPreviousSelectIndex_A=this.vSelectIndex_A;this.vSelectIndex_A=getdropdown.options.selectedIndex;this.vSelectChange_A="MANUAL_CLICK";}},fnKeyPressHandler_A:function(getdropdown,e){this.fnSanityCheck_A(getdropdown);keycode=this.FindKeyCode(e);keychar=this.FindKeyChar(e);if((keycode>47&&keycode<59)||(keycode>62&&keycode<127)||(keycode==32)||(keycode==39)){var vAllowableCharacter="yes";}else{var vAllowableCharacter="no";}if(getdropdown.options.length!=0){if(getdropdown.options.selectedIndex==(this.vEditableOptionIndex_A)){var vEditString=getdropdown[this.vEditableOptionIndex_A].value;if(vAllowableCharacter=="yes"){if((getdropdown[this.vEditableOptionIndex_A].text==this.vEditableOptionText_A)||(getdropdown[this.vEditableOptionIndex_A].value==this.vEditableOptionText_A)){vEditString="";}}if(vAllowableCharacter=="yes"){vEditString+=String.fromCharCode(keycode);var i=0;var vEnteredChar=String.fromCharCode(keycode);var vUpperCaseEnteredChar=vEnteredChar;var vLowerCaseEnteredChar=vEnteredChar;if(((keycode)>=97)&&((keycode)<=122)){vUpperCaseEnteredChar=String.fromCharCode(keycode-32);}if(((keycode)>=65)&&((keycode)<=90)){vLowerCaseEnteredChar=String.fromCharCode(keycode+32);}if(e.which){for(i=0;i<=(getdropdown.options.length-1);i++){if(i!=this.vEditableOptionIndex_A){var vReadOnlyString=getdropdown[i].value;var vFirstChar=vReadOnlyString.substring(0,1);if((vFirstChar==vUpperCaseEnteredChar)||(vFirstChar==vLowerCaseEnteredChar)){this.vSelectChange_A="AUTO_SYSTEM";break;}else{this.vSelectChange_A="MANUAL_CLICK";}}}}}getdropdown.options[this.vEditableOptionIndex_A].text=vEditString;getdropdown.options[this.vEditableOptionIndex_A].value=vEditString;return false;}}return true;},fnKeyUpHandler_A:function(getdropdown,e){this.fnSanityCheck_A(getdropdown);if(e.which){if(this.vSelectChange_A=="AUTO_SYSTEM"){getdropdown[(this.vEditableOptionIndex_A)].selected=true;}var vEventKeyCode=this.FindKeyCode(e);if((vEventKeyCode==37)||(vEventKeyCode==39)){getdropdown[this.vEditableOptionIndex_A].selected=true;}}},validateDisplayName:function(form,prefix){reWhiteSpace=new RegExp(/^\s+$/);if(prefix==null){prefix="";}if(form!=null){var displayName=prefix+"displayName";if(form[displayName]==null){return true;}form[displayName].value=trim(form[displayName].value);if(this.displayNameRequired=="true"&&(form[displayName].value==""||reWhiteSpace.test(form[displayName].value))){MessageHelper.formErrorHandleClient(form[displayName].id,MessageHelper.messages.ERROR_DisplayNameEmpty);return false;}if(form[displayName].value!=""&&!reWhiteSpace.test(form[displayName].value)){if(!MessageHelper.isValidUTF8length(form[displayName].value,16)){MessageHelper.formErrorHandleClient(form[displayName].id,MessageHelper.messages.ERROR_DisplayNameTooLong);return false;}if(/\W/.test(form[displayName].value)||(MessageHelper.utf8StringByteLength(form[displayName].value)<6)){MessageHelper.formErrorHandleClient(form[displayName].id,MessageHelper.messages.ERROR_InvalidDisplayName);return false;}}return true;}return false;},validateCodeAndPhone:function(form){reWhiteSpace=new RegExp(/^\s+$/);if(form!=null){if((form.phone1_1.value==""||reWhiteSpace.test(form.phone1_1.value))||(form.phone1_2.value==""||reWhiteSpace.test(form.phone1_2.value))){MessageHelper.formErrorHandleClient(form.phone1_2.id,MessageHelper.messages.ERROR_PhonenumberEmpty);document.getElementById(form.phone1_1.id).style.background="#ff0000";document.getElementById(form.phone1_2.id).style.background="#ff0000";return false;}if(!(MessageHelper.utf8StringByteLength(form.phone1.value)==11||MessageHelper.utf8StringByteLength(form.phone1.value)==12)){MessageHelper.formErrorHandleClient(form.phone1_2.id,MessageHelper.messages.ERROR_PhoneTooLong);document.getElementById(form.phone1_1.id).style.background="#ff0000";document.getElementById(form.phone1_2.id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form.phone1_1.value,5)){MessageHelper.formErrorHandleClient(form.phone1_2.id,MessageHelper.messages.ERROR_INVALIDPHONE);document.getElementById(form.phone1_1.id).style.background="#ff0000";return false;}if(!MessageHelper.isValidUTF8length(form.phone1_2.value,8)){MessageHelper.formErrorHandleClient(form.phone1_2.id,MessageHelper.messages.ERROR_INVALIDPHONE);document.getElementById(form.phone1_2.id).style.background="#ff0000";return false;}if(!MessageHelper.IsValidPhone(form.phone1.value)){MessageHelper.formErrorHandleClient(form.phone1_2.id,MessageHelper.messages.ERROR_INVALIDPHONE);document.getElementById(form.phone1_1.id).style.background="#ff0000";document.getElementById(form.phone1_2.id).style.background="#ff0000";return false;}return true;}return false;},createCountyAndTaxGeoCode:function(formName,paramPrefix,id,lableId,taxCodes){var form=document.getElementById(formName);if(paramPrefix==null||paramPrefix=="undefined"||paramPrefix==""){paramPrefix="";}var countyDivObj=document.getElementById(formName+"_countyDiv");var city=form[paramPrefix+"city"].value;var country=form[paramPrefix+"country"].value;var countryObj=form[paramPrefix+"country"];var zipCode=form[paramPrefix+"zipCode"].value;var stateObj=form[paramPrefix+"state"];var countySelect=document.createElement("select");var countyLabelObj=document.getElementById(formName+"_"+lableId);countySelect.setAttribute("id",paramPrefix+id);if(id=="_county1"){countySelect.setAttribute("name",paramPrefix+"_taxGeoCode");}else{countySelect.setAttribute("name",paramPrefix+"taxGeoCode");}countySelect.setAttribute("class","drop_down_country");countySelect.setAttribute("className","drop_down_country");countySelect.onchange=function(){AddressHelper.setCountySB(formName,paramPrefix,id);};countySelect.options.length=0;for(var i=0;i<taxCodes.length;i++){aOption=document.createElement("option");countySelect.options[i]=aOption;aOption.text=taxCodes[i].county;aOption.value=taxCodes[i].taxJuriCode;if(i==0){aOption.selected=true;}}countyDivObj.appendChild(countySelect);var countyInput=document.createElement("input");countyInput.setAttribute("type","hidden");countyInput.setAttribute("id",paramPrefix+"addressField1");if(id=="_county1"){countyInput.setAttribute("name",paramPrefix+"_addressField1");}else{countyInput.setAttribute("name",paramPrefix+"addressField1");}countyInput.setAttribute("value",taxCodes[0].county);countyDivObj.appendChild(countyInput);countyDivObj.style.display="block";countyLabelObj.style.display="block";form[paramPrefix+"city"].readOnly=true;form[paramPrefix+"zipCode"].readOnly=true;stateObj.disabled=true;countryObj.disabled=true;MessageHelper.formErrorHandleClient(form[paramPrefix+id].id,MessageHelper.messages.ERROR_SelectCounty);document.getElementById(form[paramPrefix+id].id).style.background="#ff0000";}};