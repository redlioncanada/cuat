dojo.registerModulePath("wc","../wc");dojo.require("wc.service.common");dojo.require("dojo.io.iframe");dojo.require("dojo.io.script");dojo.require("dojo.parser");dojo.require("dijit.form.Button");dojo.require("wc.widget.WCMenu");dojo.require("wc.widget.WCDialog");dojo.require("wc.widget.ScrollablePane");dojo.require("dijit.layout.TabContainer");dojo.require("dijit.layout.ContentPane");dojo.require("dijit.Tooltip");dojo.require("wc.widget.WCDropDownButton");dojo.require("dijit.Dialog");dojo.require("dojo.dnd.Source");dojo.require("dojo.currency");dojo.require("dijit.Tree");dojo.require("dojo.back");dojo.require("dijit.form.DateTextBox");dojo.require("wc.widget.RefreshArea");dojo.require("wc.render.RefreshController");dojo.require("wc.render.Context");dojo.require("dojo.cookie");var wantShowMiniShopcartDropdown=false;var miniShopcartRefreshPending=false;var showLastAddedItemInMiniWishList=false;var dropDownDlg=null;var isIE=(document.all)?true:false;var correctBrowser=false;var requestSubmitted=true;var currentId="";function focusSetter(){if(dojo.byId("MiniCartFocusReceiver1")){dojo.byId("MiniCartFocusReceiver1").focus();}else{dojo.byId("MiniCartFocusReceiver2").focus();}}function determineFocus(event){if(event.shiftKey&&event.keyCode==dojo.keys.TAB){if(event.srcElement){if(event.srcElement.id=="MiniCartFocusReceiver1"){if(dojo.byId("WC_MiniShopCartDisplay_link_5")){dojo.byId("WC_MiniShopCartDisplay_link_5").focus();}dojo.stopEvent(event);}else{if(event.srcElement.id=="MiniCartFocusReceiver2"){dojo.byId("MiniCartFocusReceiver2").focus();dojo.stopEvent(event);}}}else{if(event.target.id=="MiniCartFocusReceiver1"){if(dojo.byId("WC_MiniShopCartDisplay_link_5")){dojo.byId("WC_MiniShopCartDisplay_link_5").focus();}dojo.stopEvent(event);}else{if(event.target.id=="MiniCartFocusReceiver2"){dojo.byId("MiniCartFocusReceiver2").focus();dojo.stopEvent(event);}}}}}function destroyDialog(){dojo.query(".dijitDialog",document).forEach(function(tag){if(dijit.byNode(tag).id=="quick_cart_container"){dijit.byNode(tag).destroyRecursive();}});dropDownDlg=null;}function showMiniShopCartDropDown1(event,relativeId,contentId,contentType){console.debug(event.keyCode);if(event.keyCode==dojo.keys.DOWN_ARROW){showMiniShopCartDropDown(relativeId,contentId,contentType);}else{if(event.shiftKey&&event.keyCode==dojo.keys.ENTER){showMiniShopCartDropDown(relativeId,contentId,contentType);dojo.stopEvent(event);}}}function showMiniShopCartDropDown(relativeId,contentId,contentType){var t=dojo.byId(relativeId);var c=dojo.coords(t,true);var x1=c.x;var y1=c.y;if(dojo.locale=="iw-il"){var cartWidth=dojo.coords(dojo.byId("miniShopCartBody"),true).w+dojo.coords(dojo.byId("miniShopCartLeftCorner"),true).w+dojo.coords(dojo.byId("miniShopCartRightCorner"),true).w;}else{var cartWidth=dojo.coords(dojo.byId("miniShopCartBody"),true).w;}dojo.style(dojo.byId("quick_cart"),"width",cartWidth+"px");var dlgX;if(dojo.locale=="iw-il"&&dojo.isIE<7){dlgX=dojo.coords(dojo.byId("miniShopCartLeftCorner")).x;}else{dlgX=x1+dojo.contentBox(dojo.byId(relativeId)).w-cartWidth;}if(dropDownDlg){dropDownDlg.y=y1;dropDownDlg.x=dlgX;}if(!dropDownDlg){var pane=document.getElementById(contentId);var cartTimeOut=document.getElementById("timeOutMiniCartDisplay").value;dropDownDlg=new wc.widget.WCDialog({relatedSource:relativeId,x:x1,y:y1},pane);dropDownDlg.x=dlgX;dropDownDlg.timeOut=cartTimeOut;dojo.connect(dropDownDlg,"onMouseLeave",hideMiniShopCartDropDown);}if(dojo.isOpera!=0&&dojo.isOpera!=null){dropDownDlg.x=dropDownDlg.x+window.pageXOffset;dropDownDlg.y=dropDownDlg.y+window.pageYOffset;}if(contentType=="orderItemsList"){dojo.byId("MiniShopCartProductsList").style.display="block";dojo.byId("MiniShopCartProductAdded").style.display="none";}else{if(contentType=="orderItemAdded"){dojo.byId("MiniShopCartProductsList").style.display="none";dojo.byId("MiniShopCartProductAdded").style.display="block";}}setTimeout(dojo.hitch(dropDownDlg,"show",null),5);setTimeout(dojo.hitch(this,"hideUnderlayWrapper",""),5);}function hideUnderlayWrapper(){dojo.query(".dijitDialogUnderlayWrapper",document).forEach(function(tag){tag.style.display="none";});}function loadLink(url){document.location.href=url;}function clearSearchField(){searchText=document.getElementById("SimpleSearchForm_SearchTerm").value;if(searchText==document.getElementById("searchTextHolder").innerHTML){document.getElementById("SimpleSearchForm_SearchTerm").value="";}else{document.getElementById("SimpleSearchForm_SearchTerm").select();}}function fillSearchField(){if(document.getElementById("SimpleSearchForm_SearchTerm").value==""){document.getElementById("SimpleSearchForm_SearchTerm").value=document.getElementById("searchTextHolder").innerHTML;}}function showDropDownMenu(){var showMenu=document.getElementById("header_menu_dropdown");if(document.getElementById("header_menu_dropdown")!=null&&document.getElementById("header_menu_dropdown")!="undefined"){showMenu.style.display="block";}if(document.getElementById("outerCartContainer")!=null&&document.getElementById("outerCartContainer")!="undefined"){var outershopcart=document.getElementById("outerCartContainer");outershopcart.style.display="block";}}function initShopcartTarget(){dojo.subscribe("/dnd/drop",function(source,nodes,copy,target){target.deleteSelectedNodes();var actionListScroll=new popupActionProperties();actionListScroll.showProductCompare=showProductCompare;if(target.parent.id=="miniShopCart_dndTarget"){var indexOfIdentifier=source.parent.id.indexOf("_",0);if(indexOfIdentifier>=0){source.parent.id=source.parent.id.substring(indexOfIdentifier+1);}if(source.node.getAttribute("dndType")=="item"||source.node.getAttribute("dndType")=="package"){categoryDisplayJS.AddItem2ShopCartAjax(source.parent.id,1);}else{if(source.node.getAttribute("dndType")=="product"||source.node.getAttribute("dndType")=="bundle"){showPopup(source.parent.id,storeId,langId,catalogId,function(e){return e;},"miniShopCart_dndTarget",null,actionListScroll);}}}});}function cursor_wait(checkForOpera){var showPopup=true;if(checkForOpera==true){if(dojo.isOpera>0){showPopup=false;}}if(showPopup){setTimeout("showProgressBar()",500);}}function showProgressBar(){if(!requestSubmitted){return;}displayProgressBar();}function displayProgressBar(){var dialog=dijit.byId("progress_bar_dialog");if(dialog!=null){dialog.closeButtonNode.style.display="none";var progressBar=document.getElementById("progress_bar");progressBar.style.display="block";if(this.currentId!=""){var element=document.getElementById(this.currentId);var pos=dijit.placeOnScreenAroundElement(progressBar,element,{TR:"TL"});}else{dialog.containerNode.innerHTML=="";progressBar.style.left="";progressBar.style.top="";dialog.containerNode.appendChild(progressBar);dialog.show();}setTimeout("cursor_clear()",1800000);}}function setCurrentId(id){if(!requestSubmitted&&this.currentId==""){this.currentId=id;}}function trim(inword){word=inword.toString();var i=0;var j=word.length-1;while(word.charAt(i)==" "){i++;}while(word.charAt(j)==" "){j=j-1;}if(i>j){return word.substring(i,i);}else{return word.substring(i,j+1);}}function cursor_clear(){requestSubmitted=false;var dialog=dijit.byId("progress_bar_dialog");var progressBar=document.getElementById("progress_bar");if(dialog!=null){if(progressBar!=null){progressBar.style.display="none";}dialog.hide();this.currentId="";}}function submitRequest(){if(!requestSubmitted){requestSubmitted=true;return true;}return false;}function setPageLocation(newPageLink){if(!submitRequest()){return;}document.location.href=newPageLink;}function submitSpecifiedForm(form){if(!submitRequest()){return;}form.submit();}function parseWidget(id){var node;var widget=dijit.byId(id);if(widget==null||widget==undefined){if(id==null||id==undefined){node=dojo.body();}else{node=dojo.byId(id);}if(node!=null&&node!=undefined){if(node.getAttribute("dojoType")!=null&&node.getAttribute("dojoType")!=undefined){dojo.parser.instantiate([node]);}else{dojo.parser.parse(node);}}}}function parseHeader(id){var node=dojo.byId("progress_bar_dialog");var showMenu=document.getElementById("header_menu_loaded");var hideMenu=document.getElementById("header_menu_overlay");if(currentId.length==0&&document.getElementById("header_menu_loaded")!=null&&document.getElementById("header_menu_loaded")!="undefined"&&document.getElementById("header_menu_overlay")!=null&&document.getElementById("header_menu_overlay")!="undefined"&&document.getElementById("header_menu_loaded").style.display=="none"){setCurrentId((id!=null&&id!=undefined)?id:hideMenu.id);submitRequest();cursor_wait();hideMenu.style.display="none";parseWidget("header_menu_loaded");showMenu.style.display="block";cursor_clear();}}function hideElementById(elementId){var div=dojo.byId(elementId);div.style.display="none";}function showElementById(elementId){var div=dojo.byId(elementId);div.style.display="block";}function hideBackgroundImage(element){element.style.backgroundImage="none";}function showBackgroundImage(element){element.style.backgroundImage="url("+getImageDirectoryPath()+getStyleDirectoryPath()+"product_hover_background.png)";}function checkIE8Browser(){if(dojo.isIE&&dojo.isIE<=8){correctBrowser=true;}}function ApprovalToolLink(idTag,approvalToolLinkURL){checkIE8Browser();if(correctBrowser){RFQwindow=window.open(approvalToolLinkURL);}else{MessageHelper.formErrorHandleClient(idTag,MessageHelper.messages.ERROR_INCORRECT_BROWSER);return;}}function updateViewAndBeginIndexForCurrencyChange(){if(document.getElementById("fastFinderResultControls")!=null&&document.getElementById("fastFinderResultControls")!=""){if(document.SetCurrencyPreferenceForm.pageView!=null){document.SetCurrencyPreferenceForm.pageView.value=document.FastFinderForm.pageView.value;}if(document.SetCurrencyPreferenceForm.beginIndex!=null){document.SetCurrencyPreferenceForm.beginIndex.value=document.FastFinderForm.beginIndex.value;}}else{if(document.getElementById("CategoryDisplay_Widget")!=null&&document.getElementById("CategoryDisplay_Widget")!=""){if(wc.render.getContextById("CategoryDisplay_Context").properties.pageView!=""&&document.SetCurrencyPreferenceForm.pageView!=null){document.SetCurrencyPreferenceForm.pageView.value=wc.render.getContextById("CategoryDisplay_Context").properties.pageView;}if(wc.render.getContextById("CategoryDisplay_Context").properties.beginIndex!=""&&document.SetCurrencyPreferenceForm.beginIndex!=null){document.SetCurrencyPreferenceForm.beginIndex.value=wc.render.getContextById("CategoryDisplay_Context").properties.beginIndex;}}else{if(document.getElementById("Search_Result_Summary")!=null&&document.getElementById("Search_Result_Summary")!=""){if(wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsView!=""&&document.SetCurrencyPreferenceForm.pageView!=null){document.SetCurrencyPreferenceForm.pageView.value=wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsView;}if(wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsPageNum!=""&&document.SetCurrencyPreferenceForm.beginIndex!=null){document.SetCurrencyPreferenceForm.beginIndex.value=wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsPageNum;}}}}}function updateViewAndBeginIndexForLanguageChange(){if(document.getElementById("fastFinderResultControls")!=null&&document.getElementById("fastFinderResultControls")!=""){if(document.LanguageSelectionForm.pageView!=null){document.LanguageSelectionForm.pageView.value=document.FastFinderForm.pageView.value;}if(document.LanguageSelectionForm.beginIndex!=null){document.LanguageSelectionForm.beginIndex.value=document.FastFinderForm.beginIndex.value;}}else{if(document.getElementById("CategoryDisplay_Widget")!=null&&document.getElementById("CategoryDisplay_Widget")!=""){if(wc.render.getContextById("CategoryDisplay_Context").properties.pageView!=""&&document.LanguageSelectionForm.pageView!=null){document.LanguageSelectionForm.pageView.value=wc.render.getContextById("CategoryDisplay_Context").properties.pageView;}if(wc.render.getContextById("CategoryDisplay_Context").properties.beginIndex!=""&&document.LanguageSelectionForm.beginIndex!=null){document.LanguageSelectionForm.beginIndex.value=wc.render.getContextById("CategoryDisplay_Context").properties.beginIndex;}}else{if(document.getElementById("Search_Result_Summary")!=null&&document.getElementById("Search_Result_Summary")!=""){if(wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsView!=""&&document.LanguageSelectionForm.pageView!=null){document.LanguageSelectionForm.pageView.value=wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsView;}if(wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsPageNum!=""&&document.LanguageSelectionForm.beginIndex!=null){document.LanguageSelectionForm.beginIndex.value=wc.render.getContextById("catalogSearchResultDisplay_Context").properties.searchResultsPageNum;}}}}}function showHeaderLinksInTwoLines(){if(document.getElementById("header_links")!=null&&document.getElementById("header_links")!="undefined"){if(dojo.contentBox(document.getElementById("header_links")).w>750){if(document.getElementById("header_links1")!=null&&document.getElementById("header_links1")!="undefined"){document.getElementById("header_links1").style.display="block";}if(document.getElementById("headerHomeLink")!=null&&document.getElementById("headerHomeLink")!="undefined"){document.getElementById("headerHomeLink").style.display="none";}if(document.getElementById("headerShopCartLink")!=null&&document.getElementById("headerShopCartLink")!="undefined"){document.getElementById("headerShopCartLink").style.display="none";}}document.getElementById("header_links").style.visibility="visible";}}function showLinksInOneLine(){if(document.getElementById("header_links")!=null&&document.getElementById("header_links")!="undefined"){document.getElementById("header_links").style.visibility="visible";}}function isNonNegativeInteger(value){var regExpTester=new RegExp(/^\d*$/);return(value!=null&&value!=""&&regExpTester.test(value));}function isPositiveInteger(value){return(isNonNegativeInteger(value)&&value!=0);}function stringToBytes(str){var ch,st,re=[];for(var i=0;i<str.length;i++){ch=str.charCodeAt(i);st=[];do{st.push(ch&255);ch=ch>>8;}while(ch);re=re.concat(st.reverse());}return re;}function getValueFromCookie(cookieKey){var cookieValue=dojo.cookie(cookieKey);return cookieValue;}function setValueToCookie(cookieKey,cookieValue){var newValue=cookieValue;if(newValue!=null&&newValue!="undefined"&&newValue!=""){var currentValue=this.getValueFromCookie(cookieKey);if(newValue!=currentValue){dojo.cookie(cookieKey,null,{expires:-1,path:"/"});dojo.cookie(cookieKey,newValue,{path:"/"});}}}function clearValueFromCookie(cookieKey){var currentValue=this.getValueFromCookie(cookieKey);if(currentValue!=null&&currentValue!="undefined"){dojo.cookie(cookieKey,null,{expires:-1,path:"/"});}}function hideMiniShopCartDropDown(){dropDownDlg.hide();}function showMiniWishListDropDown(){var allItemsDialog=document.getElementById("allItemsList");var noOfWishListItems=document.getElementById("wishListNoOfItems").value;if(showLastAddedItemInMiniWishList){var lastAddedItemDialog=document.getElementById("lastAddedItemList");allItemsDialog.style.display="none";lastAddedItemDialog.style.display="block";lastAddedItemDialog.className="addedpopup favorites";setTimeout("hideAddedInterestItemPopup()",5000);}else{allItemsDialog.style.display="block";if(noOfWishListItems==0){var noIntItemMessagesDiv=document.getElementById("interestItemMessages");noIntItemMessagesDiv.style.display="block";}}}function hideAddedInterestItemPopup(){var allItemsDialog=document.getElementById("allItemsList");var lastAddedItemDialog=document.getElementById("lastAddedItemList");var noIntItemMessagesDiv=document.getElementById("interestItemMessages");lastAddedItemDialog.style.display="none";lastAddedItemDialog.className="popup favorites";noIntItemMessagesDiv.style.display="none";allItemsDialog.style.display="block";showLastAddedItemInMiniWishList=false;}function showInterestItemAddError(errorMessage){var allItemsDialog=document.getElementById("allItemsList");var interestItemAddErrorDiv=document.getElementById("interestItemAddError");interestItemAddErrorDiv.style.display="block";interestItemAddErrorDiv.innerHTML=errorMessage;allItemsDialog.className="addedpopup favorites";setTimeout("hideInterestItemAddError()",5000);}function hideInterestItemAddError(){var allItemsDialog=document.getElementById("allItemsList");var interestItemAddErrorDiv=document.getElementById("interestItemAddError");interestItemAddErrorDiv.style.display="none";interestItemAddErrorDiv.innerHTML="";allItemsDialog.className="popup favorites";}function trackWhereToBuy(conversionLabel){if(window.$BV!=null){$BV.SI.trackConversion({type:"WhereToBuy",label:conversionLabel,value:35});}}if(!dojo._hasResource["whr.ShadowDialog"]){dojo._hasResource["whr.ShadowDialog"]=true;dojo.provide("whr.ShadowDialog");dojo.declare("whr.ShadowDialog",[dijit.Dialog],{postMixInProperties:function(){var replaceSegment='class="dijitDialogPaneContent"></div>';if(document.getElementById("closebutton")!=null&&document.getElementById("closebutton")!="undefined"){var closeButton=document.getElementById("closebutton").value;var templateAdds='class="dijitDialogPaneContent"></div><div class="modal_closeTab"><a href="javascript:;" dojoAttachEvent="onclick: onCancel"><div class="border-right"></div><div class="modal_closeTxt">'+closeButton+' <img src="/images/icon_modal_close.png" alt="Close"></div><div class="border-left"></div></a></div><div class="corner-topLeft"></div><div class="corner-bottomRight"></div><div class="corner-bottomLeft"></div><div dojoAttachPoint="sideRight" class="sideRight"></div><div dojoAttachPoint="sideLeft" class="sideLeft"></div><div dojoAttachPoint="sideBottom" class="sideBottom"></div><div dojoAttachPoint="sideTop" class="sideTop"></div>';}else{var templateAdds='class="dijitDialogPaneContent"></div><div class="modal_closeTab"><a href="javascript:;" dojoAttachEvent="onclick: onCancel"><div class="border-right"></div><div class="modal_closeTxt">CLOSE <img src="/images/icon_modal_close.png" alt="Close"></div><div class="border-left"></div></a></div><div class="corner-topLeft"></div><div class="corner-bottomRight"></div><div class="corner-bottomLeft"></div><div dojoAttachPoint="sideRight" class="sideRight"></div><div dojoAttachPoint="sideLeft" class="sideLeft"></div><div dojoAttachPoint="sideBottom" class="sideBottom"></div><div dojoAttachPoint="sideTop" class="sideTop"></div>';}this.templateString=this.templateString.replace(replaceSegment,templateAdds);this.inherited(arguments);},postCreate:function(){this.inherited(arguments);this.connect(this,"show","_createUnderlay");this.connect(this,"hide","_destroyUnderlay");this.connect(this,"destroy","_destroyUnderlay");},_position:function(){this.inherited(arguments);var dims=dojo.marginBox(this.containerNode);dojo.style(this.sideRight,"height",(dims.h-15)+"px");dojo.style(this.sideLeft,"height",(dims.h-30)+"px");dojo.style(this.sideTop,"width",(dims.w-120)+"px");dojo.style(this.sideBottom,"width",(dims.w-30)+"px");},_createUnderlay:function(){var dims=dojo.marginBox(dojo.body());dojo.create("div",{id:this.id+"_shadowunderlay","class":"modalDialogUnderlay",style:"width: "+dims.w+"px; height: "+dims.h+"px;"},dojo.body());},_destroyUnderlay:function(){dojo.destroy(this.id+"_shadowunderlay");}});}function refreshBV(){if($("#BVarray").length>0){var productNumberArray=dojo.byId("BVarray").value.split(",");var productIDsObject={};for(var i=0;i<productNumberArray.length;i++){if(productNumberArray[i]!=""){var titleElement=dojo.byId(productNumberArray[i]+"_title");if(titleElement){var titleHref=dojo.attr(titleElement,"href")+"#ratingsandreviews";productIDsObject[productNumberArray[i]]={url:titleHref};}}}if(typeof BV!="undefined"){$BV.ui("rr","inline_ratings",{productIds:productIDsObject,containerPrefix:"BVRRInlineRating"});}if(storeId=="10202"){if(productNumberArray&&productNumberArray.length>0&&productNumberArray[0]!=""){var bvInterval=setInterval(function(){var ratingElement=dojo.byId("BVRRInlineRating-"+productNumberArray[0]);if(ratingElement&&dojo.trim(ratingElement.innerHTML)!=""){for(var i=0;i<productNumberArray.length;i++){if(productNumberArray[i]!=""){var plpGridRatingElement=dojo.byId("BVRRInlineRating-"+productNumberArray[i]+"_grid"),duplicateRatingElement=dojo.byId("BVRRInlineRating-"+productNumberArray[i]);if(plpGridRatingElement&&duplicateRatingElement){plpGridRatingElement.innerHTML=duplicateRatingElement.innerHTML;}}}clearInterval(bvInterval);}},1000);}}}}var BVarray="";var oldBVarray="";function refreshSearchBV(count){var bvMainInterval=setInterval(function(){if($("#BVarray").length>0&&dojo.byId("BVarray").value!=oldBVarray.value){var productNumberArray=dojo.byId("BVarray").value.split(",");var productDuplicates=dojo.byId("BVduplicates").value.split(",");var productIDsObject={};for(var i=0;i<productNumberArray.length;i++){if(productNumberArray[i]!=""){productIDsObject[productNumberArray[i]]={containerId:"BVRRInlineRating-"+productNumberArray[i],url:dojo.attr(dojo.byId(productNumberArray[i]+"_title"),"href")+"#ratingsandreviews"};}}if(!$.isEmptyObject(productIDsObject)&&typeof BV!="undefined"){$BV.ui("rr","inline_ratings",{productIds:productIDsObject});}if(productDuplicates.length>0){var bvInterval=setInterval(function(){if(productNumberArray[0]!=""){for(var i=0;i<productDuplicates.length;i++){if(dojo.byId("BVRRInlineRating-"+productDuplicates[i])!=undefined&&dojo.byId("BVRRInlineRating-"+productDuplicates[i]).innerHTML.trim()!=""){console.log(dojo.query(".BVRRInlineRating-"+productDuplicates[i]+"_2"));dojo.query(".BVRRInlineRating-"+productDuplicates[i]+"_2").forEach(function(node,index,nodelist){node.innerHTML=dojo.byId("BVRRInlineRating-"+productDuplicates[index]).innerHTML;});clearInterval(bvInterval);oldBVarray=BVarray;$(".sort-listing-container").click(function(){BVplaceholder();});}}}},1000);}clearInterval(bvMainInterval);}},2000);}